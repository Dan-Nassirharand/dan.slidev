---
layout: applcommon-two-cols-header
---

# Rules and Recipes

```makefile
target: prerequisites # Rule
	commands # Recipe
```

- Each recipe is run in its own subshell
- When any of the prerequisites change, the target is rebuilt
- Make is whitespace sensitive and `Recipes` are preceded by a `tab` character
- `targets` are generally files that are generated by the `recipes` of that rule

::left::
```makefile
.PHONY: all
all:
	mkdir -p bar
	cd bar
	echo “put into file in bar” >> file.txt
```

::right::

Where will file.txt be placed and why?

<!--
Turning on render whitespace in VS Code by using `ctrl + shift + p` and `View: Toggle Render Whitespace`

Tabs look like a little arrow and it is almost impossible to work on Makefiles without rendering the whitespace.
-->

---
layout: applcommon-two-cols-header
---
# Echoing
- Each recipe will is printed on the command line when executed
- Great for debugging, bad for normal use
- Using `@` at the start of a line will suppress the echoing


::left::
```makefile
.PHONY: all
all:
	echo hello
```

```makefile
.PHONY: all
all:
	@echo hello
```

::right::
```bash
$ make
echo hello
hello
```

```bash
$ make
hello
```

<!--
Need to mention global silence after variables
-->

---

# Default Rule

- The first rule in a makefile is the default rule
  - Once a makefile includes other makefiles, this can become complicated
- Specify a target by calling it out directly on the command line
  - `make -f target.mk upload`
- Any target in a makefile is valid, however the most commonly called out targets are...

---

# Phony Targets

- A modifier to a target that tells make that the target is not a real file and should always be executed

```makefile
.PHONY: clean
clean:
	@rm -rf build
```
- If added as a prerequisite to another rule, it will cause that rule to always be rerun, since this dependency is always executed

---
layout: applcommon-two-cols-header
---

# Prerequisites

- All prerequisites are run before the recipes of the target can be called

```makefile
target: prereq1 prereq2 prereq3
	<recipe>
```

- Make determines if a prerequisite has changed by the file's timestamp. If the prerequisite timestamp is newer than the target's timestamp, the target must be rebuilt
- When running with jobs, the prerequisites can be run in parallel speeding up the entire process

<!--
Don't forget taht phony targets are always marked as needing to be rebuilt

When making the prerequisites its important to think about what a target is truly dependent on. Putting extra or unneeded prerequisites can make the job take extra time that wastes everyone's time.
 -->
---

# Order Only Prerequisites

---

# Multiple Targets

---

# Explicit Rules
